class Listing < ActiveRecord::Base
  
  include AssignablePseudoFields
  
  belongs_to :agency
  belongs_to :ask_currency,
    :class_name => 'Currency',
    :foreign_key => 'ask_currency_id'
  belongs_to :close_currency, 
    :class_name => 'Currency',
    :foreign_key => 'close_currency_id'
  belongs_to :listing_type
  belongs_to :property, :include => :property_images

  has_many :category_assignments, :as => :category_assignable
  has_many :categories, :through => :category_assignments
  has_many :feature_assignments, :as => :feature_assignable
  has_many :features, :through => :feature_assignments
  has_many :style_assignments, :as => :style_assignable
  has_many :styles, :through => :style_assignments
  
  has_many :information_requests
  
  # This allows images to associated with this listing, in addition to the
  # main images that are associated with the property.
  has_many :property_images, :as => :imageable

  validates_presence_of :label
  validates_numericality_of #:agency_id,
    :listing_type_id,
    :property_id
    #:ask_amount,
    #:ask_currency_id,
    #:close_amount,
    #:close_currency_id,
    
  
end
