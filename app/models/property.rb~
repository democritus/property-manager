class Property < ActiveRecord::Base
  
  include AssignablePseudoFields
  #has_assignable_pseudo_fields
  
  belongs_to :barrio, :include => true
  has_many :listings
  has_many :property_images, :as => :imageable
  
  has_many :category_assignments, :as => :category_assignable
  has_many :categories, :through => :category_assignments
  has_many :feature_assignments, :as => :feature_assignable
  has_many :features, :through => :feature_assignments
  has_many :style_assignments, :as => :style_assignable
  has_many :styles, :through => :style_assignments

  validates_presence_of :name
  validates_numericality_of :barrio_id, 
    :bathroom_number, 
    :bedroom_number, 
    :construction_size, 
    :land_size, 
    :parking_spaces, 
    :year_built, 
    :stories
  validate :bathroom_number_must_be_whole_or_half

  def bathroom_number_must_be_whole_or_half
    if bathroom_number.nil? then
      return
    else
      bathTimesTen = (bathroom_number * 10).to_i # Decimal values have precision problems
      unless (bathTimesTen % 5) == 0
        errors.add(:bathroom_number, ' should be either a whole number or half ')
      end
    end
  end
  
end
