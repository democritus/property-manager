class Category < ActiveRecord::Base
  has_many :category_assignments
  has_many :listing_types, :through => :category_assignments
  has_many :listings, :through => :category_assignments
  has_many :properties, :through => :category_assignments
  
  after_save :enforce_one_primary_category
  
  def enforce_one_primary_category
    unless self.primary_style.nil
      if self.primary_style.to_s == '1'
        self.update_all(
          { :primary_style => false },
          'id <> "' + self.id + '"'
        )
      end
    end
  end
end
